<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.douzone.rest.saallowpay.dao.SaAllowPayMapper">

    <select id="getSaAlLowPayList" parameterType="SaAllowPay" resultType="SaAllowPay">
        SELECT s.CD_ALLOW,
            a.NM_ALLOW,
            a.YN_TAX AS YN_TAX_ALLOW,
            nvl(s.ALLOW_PAY,0) AS ALLOW_PAY,
            s.CD_EMP,
            s.ALLOW_MONTH,
            s.ALLOW_YEAR,
            s.PAYMENT_DATE
        FROM SAALLOWPAY s LEFT OUTER JOIN SAALLOW a
            ON s.CD_ALLOW = a.CD_ALLOW
        WHERE CD_EMP = #{cdEmp}
            AND ALLOW_MONTH = #{allowMonth}
        <if test="cdAllow                    != null"> AND CD_ALLOW = #{cdAllow} </if>
    </select>

    <update id="updateSaAllowPay" parameterType="SaAllowPay">
        update SAALLOWPAY
            set ALLOW_PAY = #{allowPay}
        where CD_EMP = #{cdEmp}
            AND ALLOW_MONTH = #{allow_month}
    </update>


</mapper>