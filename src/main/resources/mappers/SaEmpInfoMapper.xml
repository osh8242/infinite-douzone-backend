<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.douzone.rest.saempinfo.dao.SaEmpInfoMapper">

    <select id="getDateId" parameterType="java.util.Map" resultType="String">
        SELECT DATE_ID
            FROM "DATE"
        WHERE ALLOW_YEAR = #{allowYear}
            AND "MONTH"=#{allowMonth}
            AND "DATE"=#{paymentDate}
    </select>

    <select id="getSaEmpInfoList" parameterType="java.util.Map" resultType="SaEmpInfo">
        SELECT DISTINCT p.CD_EMP, e.NM_KRNAME AS NM_EMP, e.RANK_NO , i.MN_REDUCTION
            FROM SAALLOWPAY p LEFT OUTER JOIN SAALLOW s
                ON p.CD_ALLOW = s.CD_ALLOW LEFT OUTER JOIN SAEMPINFO i
                ON p.CD_EMP = i.CD_EMP LEFT OUTER JOIN "DATE" d
                ON d.DATE_ID = p.DATE_ID LEFT OUTER JOIN EMP e
                ON p.CD_EMP = e.CD_EMP
            WHERE d.DATE_ID = #{dateId}
                AND s.SAL_DIVISION = #{salDivision}
        <if test="searchCdEmp       != null and searchCdEmp       != ''">   AND i.CD_EMP       = #{searchCdEmp}      </if>
        <if test="searchCdDept      != null and searchCdDept      != ''">   AND i.CD_DEPT      = #{searchCdDept}     </if>
        <if test="searchRankNo      != null and searchRankNo      != ''">   AND i.RANK_NO      = #{searchRankNo}     </if>
        <if test="searchCdOccup     != null and searchCdOccup     != ''">   AND i.CD_OCCUP     = #{searchCdOccup}    </if>
<!--        <if test="searchCdField     != null and searchCdField     != ''">   AND i.CD_FIELD     = #{searchCdField}    </if>-->
<!--        <if test="searchCdProject   != null and searchCdProject   != ''">   AND i.CD_PROJECT   = #{searchCdProject}  </if>-->
        <if test="searchYnUnit      != null and searchYnUnit      != ''">   AND i.YN_UNIT      = #{searchYnUnit}     </if>
        <if test="searchYnForlabor  != null and searchYnForlabor  != ''">   AND i.YN_FORLABOR  = #{searchYnForlabor} </if>
    </select>

    <select id="getSaEmpInfoByCdEmp" parameterType="java.util.Map" resultType="SaEmpInfo">
        SELECT CD_EMP
            , (SELECT NM_KRNAME FROM EMP e WHERE e.CD_EMP = s.CD_EMP) as NM_EMP
            , MN_1_1_1
            , DA_ENTER
            , YN_MATEDED
            , NUM_20FAMILY || '/' || NUM_60FAMILY || '/' || NUM_MANYFAMILY as num2060many
            , YN_RESIDENT
            , YN_UNIT || '/' || YN_FORLABOR as ynUnitForlabor
            , YN_OVERWORK
            , DA_RETIRE
            , CD_OCCUP
            , RANK_NO
            , CD_DEPT
            , CD_FIELD
            , CD_PROJECT
            , AM_NATIONPEN
            , AM_HEALTHINSUR
            , MN_2_1_1
            , NO_SOCIAL
            , MN_REDUCTION
        FROM SAEMPINFO s
        WHERE CD_EMP = #{cdEmp}
    </select>

    <insert id="insertSaEmpInfo" parameterType="SaEmpInfo">
        INSERT INTO SAEMPINFO (
            
        ) VALUES (

        )
    </insert>

    <delete id="deleteSaEmpInfo" parameterType="SaEmpInfo">
        DELETE
        FROM SAEMPINFO
        WHERE CD_EMP = #{cdEmp}
    </delete>

    <update id="updateEmpInfo" parameterType="SaEmpInfo">
        UPDATE SAEMPINFO
        SET CD_EMP = #{cdEmp}
            <if test="mn111                    != null">, MN_1_1_1 = #{mn111}</if>
            <if test="daEnter                  != null">, DA_ENTER = #{daEnter}</if>
            <if test="ynMateDed                != null">, YN_MATEDED = #{ynMateDed}</if>
            <if test="num20Family              != null">, NUM_20FAMILY = #{num20Family}</if>
            <if test="num60Family              != null">, NUM_60FAMILY = #{num60Family}</if>
            <if test="numManyFamily            != null">, NUM_MANYFAMILY = #{numManyFamily}</if>
            <if test="ynResident               != null">, YN_RESIDENT = #{ynResident}</if>
            <if test="ynUnit                   != null">, YN_UNIT = #{ynUnit}</if>
            <if test="ynForLabor               != null">, YN_FORLABOR = #{ynForLabor}</if>
            <if test="ynOverwork               != null">, YN_OVERWORK = #{ynOverwork}</if>
            <if test="cdOccup                  != null">, CD_OCCUP = #{cdOccup}</if>
            <if test="rankNo                   != null">, RANK_NO = #{rankNo}</if>
            <if test="cdDept                   != null">, CD_DEPT = #{cdDept}</if>
            <if test="cdField                  != null">, CD_FIELD = #{cdField}</if>
            <if test="cdProject                != null">, CD_PROJECT = #{cdProject}</if>
            <if test="amNationPen              != null">, AM_NATIONPEN = #{amNationPen}</if>
            <if test="amHealthInsur            != null">, AM_HEALTHINSUR = #{amHealthInsur}</if>
            <if test="mn211                    != null">, MN_2_1_1 = #{mn211}</if>
            <if test="noSocial                 != null">, NO_SOCIAL = #{noSocial}</if>
        WHERE CD_EMP = #{cdEmp}
    </update>


</mapper>